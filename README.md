# SD card extension for OpenFAT library

This repository contains SD/MMC card driver for the [OpenFAT library](https://github.com/tmolteno/openfat). The SD card driver implements on top of the [LibOpenCM3 library](https://libopencm3.org/) and, it supports for [STM32 - ARM Cortex-M3](https://www.st.com/en/microcontrollers-microprocessors/stm32-32-bit-arm-cortex-mcus.html) series of MCUs.

In the default configuration, the SD card driver uses the *SPI2* peripheral of the MCU for SD card interfacing. The *PORTA* pin 8 is used to issue the chip-select (*CS*) signal.

## Building the library

GNU ARM Embedded toolchain is the most recommended toolchain to build this library.

To build the entire project, use the `make` command.

## Test Setup

![Schematic of the test setup](https://raw.githubusercontent.com/dilshan/sdfatlib/main/schematic/sdfatlib-stm32f103c8con.jpg)

Required hardware modules for the test setup:

- STM32F103C8T6 Blue Pill development board
- Micro SD card module (for example [SparkFun microSD Transflash Breakout](https://www.sparkfun.com/products/544))
- 3.3V UART to USB converter (for example [CH340 UART to USB converter](https://www.sparkfun.com/products/14050))

The CH340 UART to USB converter is an optional module and is used to monitor the debug logs generated by the library. 

In the default configuration, the debug logs are disabled in the Make file. To enable the debug logs, compile and build the test application with the `DEBUG_LOG` preprocessor option.

## License

The code is released under the terms of the [GNU General Public License](https://github.com/dilshan/sdfatlib/blob/main/LICENSE) (GPL), version 3 or later.
